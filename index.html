<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[rEd] Train Conductor Rotation</title>

    <!-- Link zur externen CSS-Datei -->
    <link rel="stylesheet" href="style.css">

    <!-- Firebase Libraries -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>[rEd] Dead Redemption - Train Conductor Rotation</h1>
            <p>Server #749 (Shared)</p>
        </header>

        <!-- Current Day and Controls -->
        <section class="controls-section">
            <h2>Today's Status & Actions</h2>
            <div id="current-day">
                 <div id="current-day-info">
                    <p><strong>Date:</strong> <span id="current-date">Loading...</span></p>
                    <p><strong>Day:</strong> <span id="current-day-of-week">---</span></p>
                    <p><strong>Conductor:</strong> <span id="current-conductor">---</span></p>
                    <p><strong>Proposed VIP:</strong> <span id="current-vip">---</span></p>
                </div>
                 <div id="last-completed-day-info">
                    <p><strong>Last Completed:</strong> <span id="last-completed-date">---</span></p>
                    <p style="font-size: 0.9em;">Conductor: <span id="last-completed-conductor">---</span>, VIP: <span id="last-completed-vip">---</span></p>
                </div>
                <div id="mvp-selection-area">
                    <label for="mvp-select">Select Today's MVP Conductor:</label>
                    <select id="mvp-select"> <option value="">-- Select MVP --</option> </select>
                </div>
                <div id="vip-actions">
                     <p>Did the proposed VIP accept?</p>
                     <button id="vip-accepted" class="btn-primary btn-vip-action" disabled>Yes, VIP Accepted</button>
                     <button id="vip-skipped" class="btn-secondary btn-vip-action" disabled>No, VIP Skipped</button>
                </div>
                <div id="alternative-vip-area">
                    <p><strong id="original-skipped-vip-name">---</strong> was skipped and added to priority queue.</p>
                    <label for="alternative-vip-select">Select Alternative VIP for Today (Optional):</label>
                    <select id="alternative-vip-select"> <option value="">-- No Alternative VIP --</option> </select>
                    <button id="confirm-alternative-vip" class="btn-primary" style="margin-top: 10px;">Confirm & Advance Day</button>
                </div>
                 <div id="advance-controls" style="margin-top: 15px;">
                    <button id="undo-advance" class="btn-secondary" disabled>Undo Last Advancement</button>
                 </div>
            </div>
        </section>

        <!-- Skipped VIPs Queue -->
        <section class="skipped-section">
             <h2>Skipped VIP Queue (Priority)</h2>
             <div id="skipped-vips">
                 <p>Queue is empty.</p> <ul></ul>
             </div>
        </section>

        <!-- Rotation Schedule -->
        <section class="schedule-section">
             <h2>Upcoming Rotation Schedule</h2>
             <p>Showing the next full cycle of Members receiving VIP.</p>
             <div id="schedule-display"> <ul></ul> </div>
        </section>

        <!-- Statistics Section -->
        <section class="stats-section">
             <h2>Statistics</h2>
             <div class="stats-container">
                 <div id="mvp-stats"> <h3>MVP Counts</h3> <ul></ul> </div>
                 <div id="vip-stats"> <h3>VIP Counts</h3> <ul></ul> </div>
             </div>
        </section>

        <!-- Member Management (Collapsible) -->
        <section class="member-section">
            <h2>Manage Alliance Members</h2>
            <div id="add-member-form-container">
                 <h3>Add New Member</h3>
                 <form id="add-member-form" class="form-group">
                     <label for="new-member-name">Name:</label> <input type="text" id="new-member-name" required>
                     <label for="new-member-rank">Rank:</label> <select id="new-member-rank"> <option value="Member">Member</option> <option value="R4">R4</option> <option value="R5">R5</option> </select>
                     <button type="submit" class="btn-primary" style="margin-top: 10px;">Add Member</button>
                 </form>
            </div>
            <details id="member-list-details" style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 15px;">
                <summary> Show/Hide Current Members (<span id="member-count">0</span>) </summary>
                <ul id="member-list"></ul>
            </details>
        </section>

        <!-- Admin Controls (Collapsible) -->
        <!--
        <section class="admin-section">
            <!-- H2 bleibt außerhalb für die Sektionsüberschrift -->
            <h2>Admin</h2>
            <details>
                <summary>Show/Hide Admin Controls</summary>
                <div style="margin-top: 15px;"> <!-- Container für Innenabstand -->
                    <p>Use reset only if absolutely necessary. It affects everyone.</p>
                    <button id="reset-data" class="btn-remove">Reset All Data to Defaults</button>
                </div>
            </details>
        </section>
        -->

        <!-- Footer mit Versionsanzeige -->
        <footer><p style="text-align: center; font-size: 0.8em; margin-top: 20px; color: var(--accent-color);">Tool Version: <span id="script-version">?</span></p></footer>
    </div>

    <!-- Link zur externen JavaScript-Datei -->
    <script defer src="script.js"></script>
</body>
</html>
